/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package chapter1_challenge_1_1;
 
import java.util.Scanner;
import java.util.InputMismatchException;

public class The_Cryptic_Message_Decoder {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        boolean continueProgram = true;
        
        System.out.println("Welcome to Secret Agent Cryptic Message Decoder!");
        System.out.println("==================================================");
        
        while (continueProgram) {
            int number = 0;
            boolean validInput = false;
            
             while (!validInput) {
                try {
                    System.out.print("\nEnter a positive integer (at least 2 digits): ");
                    number = scanner.nextInt();
                    
                     if (number <= 0) {
                        System.out.println(" Error: Please enter a POSITIVE integer (greater than 0).");
                        continue;
                    }
                    
                     if (number < 10) {
                        System.out.println("Error: Please enter a number with at least 2 digits.");
                        continue;
                    }
                    
                    validInput = true;
                    
                } catch (InputMismatchException e) {
                    System.out.println(" Error: That's not a valid number! Please enter digits only.");
                    scanner.next(); // Clear invalid input
                }
            }
            
            // Decode the number (use string-based extraction for safety)
            try {
                String numStr = Integer.toString(number);
                int len = numStr.length();

                int firstDigit = Character.getNumericValue(numStr.charAt(0));
                int secondDigit = Character.getNumericValue(numStr.charAt(1));
                int secondLastDigit = Character.getNumericValue(numStr.charAt(len - 2));
                int lastDigit = Character.getNumericValue(numStr.charAt(len - 1));

                int product = firstDigit * lastDigit;
                int sum = secondDigit + secondLastDigit;

                // Combine as final code (concatenate numbers)
                String result = product + "" + sum;

                System.out.println("\nDECODING RESULTS:");
                System.out.println("====================");
                System.out.println("Original message: " + number);
                System.out.println("First digit: " + firstDigit);
                System.out.println("Last digit: " + lastDigit);
                System.out.println("Product (first Ã— last): " + product);
                System.out.println("Second digit: " + secondDigit);
                System.out.println("Second-last digit: " + secondLastDigit);
                System.out.println("Sum (second + second-last): " + sum);
                System.out.println("Final decoded code: " + result);

            } catch (Exception e) {
                System.out.println(" Error during decoding: " + e.getMessage());
            }
            
            // Ask if user wants to continue
            boolean validChoice = false;
            while (!validChoice) {
                try {
                    System.out.println("\n--- What would you like to do? ---");
                    System.out.println("1. Continue decoding another number");
                    System.out.println("2. Leave the program");
                    System.out.print("Enter your choice (1 or 2): ");
                    
                    int choice = scanner.nextInt();
                    
                    if (choice == 1) {
                        validChoice = true;
                        System.out.println("\n Continuing with new number...");
                    } else if (choice == 2) {
                        validChoice = true;
                        continueProgram = false;
                        System.out.println("\nThank you for using Secret Agent Decoder!");
                        System.out.println("Mission completed! ðŸŽ‰");
                    } else {
                        System.out.println(" Please enter 1 or 2 only.");
                    }
                    
                } catch (InputMismatchException e) {
                    System.out.println(" Error: Please enter 1 or 2 only.");
                    scanner.next(); // Clear invalid input
                }
            }
        }
        
        scanner.close();
        System.out.println("ðŸ”’ Scanner closed. Program ended safely.");
    }
}
